<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulator — Simulator • contextual</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>


<meta property="og:title" content="Simulator — Simulator" />

<meta property="og:description" content="The entry point of any contextual simulation." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">contextual</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.8.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cmabs.html">Demo: Basic Synthetic cMAB Policies</a>
    </li>
    <li>
      <a href="../articles/cmabsoffline.html">Demo: Offline cMAB LinUCB evaluation</a>
    </li>
    <li>
      <a href="../articles/eckles_kaptein.html">Demo: MAB Replication Eckles &amp; Kaptein (Bootstrap Thompson Sampling)</a>
    </li>
    <li>
      <a href="../articles/epsilongreedy.html">Demo: Basic Epsilon Greedy</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Getting started: running simulations</a>
    </li>
    <li>
      <a href="../articles/mabs.html">Demo: MAB Policies Comparison</a>
    </li>
    <li>
      <a href="../articles/ml10m.html">Demo: MovieLens 10M Dataset</a>
    </li>
    <li>
      <a href="../articles/offline_depaul_movies.html">Demo: Offline cMAB: CarsKit DePaul Movie Dataset</a>
    </li>
    <li>
      <a href="../articles/only_pkgdown/faq.html">Development FAQ</a>
    </li>
    <li>
      <a href="../articles/replication.html">Offline evaluation: Replication of Li et al 2010</a>
    </li>
    <li>
      <a href="../articles/simpsons.html">Demo: Bandits, Propensity Weighting &amp; Simpson's Paradox in R</a>
    </li>
    <li>
      <a href="../articles/sutton_barto.html">Demo: Replication Sutton &amp; Barto, Reinforcement Learning: An Introduction, Chapter 2</a>
    </li>
    <li>
      <a href="../articles/website_optimization.html">Demo: Replication of John Myles White, Bandit Algorithms for Website Optimization</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../articles/only_pkgdown/faq.html">FAQ</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Nth-iteration-labs/contextual">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulator</h1>
    <small class="dont-index">Source: <a href='https://github.com/Nth-iteration-labs/contextual/blob/master/R/simulator.R'><code>R/simulator.R</code></a></small>
    <div class="hidden name"><code>Simulator.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The entry point of any <span class="pkg">contextual</span> simulation.</p>
    
    </div>

        
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A Simulator takes, at a minimum, one or more <code><a href='Agent.html'>Agent</a></code> instances, a horizon
(the length of an individual simulation, <em>t</em> = 1, &#8230;, T) and the number of simulations
(How many times to repeat each simulation over <em>t</em> = 1, &#8230;, T, with a new seed
on each repeat*).</p>
<p>It then runs all simulations (in parallel by default), keeping a log of all <code><a href='Policy.html'>Policy</a></code> and
<code><a href='Bandit.html'>Bandit</a></code> interactions in a <code><a href='History.html'>History</a></code> instance.</p>
<p>* Note: to be able to fairly evaluate and compare each agent's performance, and to make sure that
simulations are replicable, for each separate agent, seeds are set equally and deterministically for
each agent over all <code>horizon x simulations</code> time steps.</p>
<p><img src='figures/1simulator.jpeg' alt='contextual diagram: simulator' /></p>
    
    <h2 class="hasAnchor" id="usage"><a class="anchor" href="#usage"></a>Usage</h2>

    
    <pre>
simulator &lt;- Simulator$new(agents,
                           horizon = 100L,
                           simulations = 100L,
                           save_interval = 1,
                           save_context = FALSE,
                           save_theta = FALSE,
                           do_parallel = TRUE,
                           worker_max = NULL,
                           t_over_sims = FALSE,
                           set_seed = 0,
                           progress_file = FALSE,
                           include_packages = NULL)
</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>

    
    <dl class='dl-horizontal'>
<dt><code>agents</code></dt><dd><p>An <code>Agent</code> instance or a <code>list</code> of <code>Agent</code> instances.</p></dd>
<dt><code>horizon</code></dt><dd><p><code>integer</code>. The number of pulls or time steps to run each agent, where <em>t</em> = 1, &#8230;, T.</p></dd>
<dt><code>simulations</code></dt><dd><p><code>integer</code>. How many times to repeat each agent's simulation over <em>t</em> = 1, &#8230;, T,
with a new seed on each repeat (itself deterministically derived from set\_seed).</p></dd>
<dt><code>save_interval</code></dt><dd><p><code>integer</code>. Write data to historyonly every <code>save_interval</code> time steps. Default is 1.</p></dd>
<dt><code>save_context</code></dt><dd><p><code>logical</code>. Save the context matrices <code>X</code> to the History log during a simulation?</p></dd>
<dt><code>save_theta</code></dt><dd><p><code>logical</code>. Save the parameter list <code>theta</code> to the History log during a simulation?</p></dd>
<dt><code>do_parallel</code></dt><dd><p><code>logical</code>. Run <code>Simulator</code> processes in parallel?</p></dd>
<dt><code>worker_max</code></dt><dd><p><code>integer</code>. Specifies how many parallel workers are to be used.
If unspecified, the amount of workers defaults to <code>max(workers_available)-1</code>.</p></dd>
<dt><code>t_over_sims</code></dt><dd><p><code>logical</code>. Of use to, among others, offline Bandits.
If <code>t_over_sims</code> is set to <code>TRUE</code>, the current <code>Simulator</code>
iterates over all rows in a data set for each repeated simulation.
If <code>FALSE</code>, it splits the data into <code>simulations</code> parts,
and a different subset of the data for each repeat of an agent's simulation.</p></dd>
<dt><code>set_seed</code></dt><dd><p><code>integer</code>. Sets the seed of R's random number generator for the current <code>Simulator</code>.</p></dd>
<dt><code>progress_file</code></dt><dd><p><code>logical</code>. If <code>TRUE</code>, <code>Simulator</code> writes <code>workers_progress.log</code>,
<code>agents_progress.log</code> and <code>parallel.log</code> files to the current working directory,
allowing you to keep track of respectively <code>workers</code>, <code>agents</code>,
and potential errors when running a <code>Simulator</code> in parallel mode.</p></dd>
<dt><code>log_interval</code></dt><dd><p><code>integer</code>. Sets the log write interval. Default every 1000 time steps.</p></dd>
<dt><code>include_packages</code></dt><dd><p><code>List</code>. List of packages that (one of) the policies depend on. If a <code>Policy</code> requires an
R package to be loaded, this option can be used to load that package on each of the workers.
Ignored if <code>do_parallel</code> is <code>FALSE</code>.</p></dd>
<dt><code>chunk_multiplier</code></dt><dd><p><code>integer</code> By default, simulations are equally divided over available workers, and every
worker saves its simulation results to a local history file which is then aggregated.
Depending on workload, network bandwith, memory size and other variables it can sometimes be useful to
break these workloads into smaller chunks. This can be done by setting the chunk_multiplier to some
integer value, where the number of chunks will total chunk_multiplier x number_of_workers.</p></dd>
<dt><code>policy_time_loop</code></dt><dd><p><code>logical</code> In the case of replay style bandits, a Simulator's horizon equals the number of
accepted plus the number of rejected data points or samples. If <code>policy_time_loop</code> is <code>TRUE</code>,
the horizon equals the number of accepted data points or samples. That is, when <code>policy_time_loop</code>
is <code>TRUE</code>, a Simulator will keep running until the number of data points saved to History is
equal to the Simulator's horizon.</p></dd>
    </dl>
    
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
    <dl class='dl-horizontal'>
    <dt><code>reset()</code></dt><dd><p>Resets a <code>Simulator</code> instance to its original initialisation values.</p></dd>
    <dt><code>run()</code></dt><dd><p>Runs a <code>Simulator</code> instance.</p></dd>
<dt><code>history</code></dt><dd><p>Active binding, read access to Simulator's History instance.</p></dd>
    </dl>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Core contextual classes: <code><a href='Bandit.html'>Bandit</a></code>, <code><a href='Policy.html'>Policy</a></code>, <code>Simulator</code>,
<code><a href='Agent.html'>Agent</a></code>, <code><a href='History.html'>History</a></code>, <code><a href='Plot.html'>Plot</a></code></p>
<p>Bandit subclass examples: <code><a href='BasicBernoulliBandit.html'>BasicBernoulliBandit</a></code>, <code><a href='ContextualLogitBandit.html'>ContextualLogitBandit</a></code>,  <code><a href='OfflineReplayEvaluatorBandit.html'>OfflineReplayEvaluatorBandit</a></code></p>
<p>Policy subclass examples: <code><a href='EpsilonGreedyPolicy.html'>EpsilonGreedyPolicy</a></code>, <code><a href='ContextualLinTSPolicy.html'>ContextualLinTSPolicy</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
  <span class='no'>policy</span>    <span class='kw'>&lt;-</span> <span class='no'>EpsilonGreedyPolicy</span>$<span class='fu'>new</span>(<span class='kw'>epsilon</span> <span class='kw'>=</span> <span class='fl'>0.1</span>)
  <span class='no'>bandit</span>    <span class='kw'>&lt;-</span> <span class='no'>BasicBernoulliBandit</span>$<span class='fu'>new</span>(<span class='kw'>weights</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.6</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span>))
  <span class='no'>agent</span>     <span class='kw'>&lt;-</span> <span class='no'>Agent</span>$<span class='fu'>new</span>(<span class='no'>policy</span>, <span class='no'>bandit</span>, <span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"E.G."</span>, <span class='kw'>sparse</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)

  <span class='no'>history</span>   <span class='kw'>&lt;-</span> <span class='no'>Simulator</span>$<span class='fu'>new</span>(<span class='kw'>agents</span> <span class='kw'>=</span> <span class='no'>agent</span>,
                             <span class='kw'>horizon</span> <span class='kw'>=</span> <span class='fl'>10</span>,
                             <span class='kw'>simulations</span> <span class='kw'>=</span> <span class='fl'>10</span>)$<span class='fu'>run</span>()

  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>history</span>)

  <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>history</span>)

  <span class='no'>dt</span> <span class='kw'>&lt;-</span> <span class='no'>history</span>$<span class='fu'><a href='History.html'>get_data_table</a></span>()

  <span class='no'>df</span> <span class='kw'>&lt;-</span> <span class='no'>history</span>$<span class='fu'><a href='History.html'>get_data_frame</a></span>()

  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>history</span>$<span class='no'>cumulative</span>$<span class='no'>E.G.</span>$<span class='no'>cum_regret_sd</span>)

  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>history</span>$<span class='no'>cumulative</span>$<span class='no'>E.G.</span>$<span class='no'>cum_regret</span>)

<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#details">Details</a></li>

      <li><a href="#usage">Usage</a></li>

      <li><a href="#arguments">Arguments</a></li>

      <li><a href="#methods">Methods</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Robin van Emden.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '7d3ef95d72d5a68e705ce87f9919b959',
    indexName: 'nth_iteration_labs_contextual',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>


  </body>
</html>

